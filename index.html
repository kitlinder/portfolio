<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Document</title>
</head>
<body>
    <header>Header content</header>
    <main>
        Main content
    </main>
    <footer>
        <div>
            Footer content
        </div>
        <a href="https://linkedin.com/in/kitlinder">LinkedIn</a>
        <a href="/resume.pdf">Resume</a>
    </footer>
    <!-- Import maps polyfill -->
    <!-- Remove this when import maps will be widely supported -->

    <script async src="https://unpkg.com/es-module-shims@1.3.6/dist/es-module-shims.js"></script>
    
    <script type="importmap">
        {
            "imports": {
                "three": "https://unpkg.com/three@0.138.0/build/three.module.js",
                "OrbitControls": "https://unpkg.com/three@0.138.0/examples/jsm/controls/OrbitControls.js",
                "OBJLoader": "https://unpkg.com/three@0.138.0/examples/jsm/loaders/OBJLoader.js"
            }
        }
    </script>
    
    <script type="module">
        import * as THREE from 'three';

        import { OrbitControls } from 'OrbitControls';
        import { OBJLoader } from 'OBJLoader';

        const obj3d = new THREE.Object3D();

        var scene = new THREE.Scene();
        var camera = new THREE.PerspectiveCamera(75, window.innerWidth / window.innerHeight);

        var renderer = new THREE.WebGLRenderer({ antialias: true });
        renderer.setSize(window.innerWidth, window.innerHeight);
        document.body.append(renderer.domElement);

        renderer.render(scene, camera);

        var controls = new OrbitControls(camera, renderer.domElement);
        controls.minDistance = 10;
        controls.maxDistance = 20;
        controls.enablePan = false;
        controls.enableDamping = true;
        controls.dampingFactor = 0.05;

        animate();

        const width = window.innerWidth;
        const height = window.innerHeight;

        const loader = new OBJLoader();
        loader.load('demo_1.obj', function (object) {
            console.log('loading')
            let scale = 10;
            object.traverse(function (child) {
                if (child instanceof THREE.Mesh) {
                    child.geometry.center();
                    child.geometry.computeBoundingSphere();
                    // scale = 0.2 * child.geometry.boundingSphere.radius;
                    const phongMaterial = new THREE.MeshBasicMaterial({ color: 0xff0000 });
                    child.material = phongMaterial;
                    child.receiveShadow = true;
                    child.castShadow = true;
                }
            });

            object.scale.divideScalar(scale);

            scene.add(object)
        });

        window.addEventListener('resize', onWindowResize);

        function onWindowResize() {
            const width = window.innerWidth;
            const height = window.innerHeight;
            camera.aspect = width / height;
            camera.updateProjectionMatrix();
            renderer.setSize(width, height);
        }

        function animate() {
            renderer.render(scene, camera);
            requestAnimationFrame(animate);
            controls.update();
        }

    </script>
</body>
</html>
